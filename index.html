<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Parts Selector</title>
    <style>
        body {
            font-family: 'Gill Sans MT', sans-serif;
            text-align: center;
            margin: 50px;
        }
        .image-display {
            margin-top: 20px;
            display: none;
        }
        .image-container {
            position: relative;
            display: inline-block;
            margin: 10px;
            overflow: hidden;
        }
        .image-container img {
            width: 200px;
            cursor: pointer;
            border: 4px solid transparent;
            transition: transform 0.6s ease, box-shadow 0.1s ease;
        }
        .image-container:hover img {
            transform: scale(1.5);
            box-shadow: 0px 8px 15px rgba(0, 0, 0, 0.3);
        }
        .text-overlay {
            position: absolute;
            top: 75%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 150%;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.2em;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            visibility: hidden;
            opacity: 0;
            transition: visibility 0.2s, opacity 0.1s;
            pointer-events: none;
        }
        .image-container:hover .text-overlay {
            visibility: visible;
            opacity: 1;
        }
        .image-container img.selected {
            border-color: orange;
        }
        .purchase-suggestion {
            margin-top: 20px;
            display: none;
            font-size: 1.2em;
            color: green;
        }
        .purchase-button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #28a745;
            color: white;
            border: none;
            cursor: pointer;
        }
        .purchase-button:hover {
            background-color: #218838;
        }
        .button-container {
            margin-bottom: 20px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }
        .fade-in {
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }
        .fade-in.visible {
            opacity: 1;
        }
        .button-container button {
            padding: 10px 20px;
            border: 2px solid #ddd;
            background-color: #f8f8f8;
            cursor: pointer;
            transition: background-color 0.3s;
            margin: 5px; /* Space between buttons */
        }
        .button-container button.selected {
            border-color: orange;
            background-color: #e0e0e0;
        }
        .button-container button:hover {
            background-color: #e0e0e0;
        }
    </style>
</head>
<body>
    <h3>Select Make, Model and Model Year to Find and View Verified Rimgard Compatible Wheels</h3>

    <!-- Button Container for Car Make -->
    <div class="button-container" id="make-buttons">
        <!-- Buttons will be populated here -->
    </div>

    <!-- Button Container for Car Model -->
    <div class="button-container fade-in" id="model-buttons">
        <!-- Buttons will be populated here -->
    </div>

    <!-- Button Container for Car Year -->
    <div class="button-container fade-in" id="year-buttons">
        <!-- Buttons will be populated here -->
    </div>

    <!-- Section to Display Car Parts Images -->
    <div class="image-display" id="image-display">
        <h3>Verified Rimgard Compatible Wheels:</h3>
        <div id="image-container"></div>
    </div>

    <!-- Purchase Suggestion Section -->
    <div class="purchase-suggestion" id="purchase-suggestion">
        <p>You have selected part number: <span id="selected-part-number"></span></p>
        <button class="purchase-button" onclick="suggestPurchase()">Add to Cart</button>
    </div>

    <script>
        let carData = [];
        let partsData = {};

        // URL to fetch the CSV file from
        const csvUrl = 'https://cdn.shopify.com/s/files/1/0254/7675/9597/files/Data_for_RG_Original.csv?v=1726595271'; // Replace with your actual CSV file URL

        // Function to load the CSV file from the URL
        function loadCSVFromURL() {
            fetch(csvUrl)
                .then(response => response.text())
                .then(csvData => parseCSV(csvData))
                .catch(error => {
                    console.error('Error fetching the CSV file:', error);
                    alert('Failed to load CSV file from the URL.');
                });
        }

        // Simple CSV parser function
        function parseCSV(data) {
            const lines = data.trim().split('\n');
            const headers = lines[0].split(',');

            carData = [];
            partsData = {};

            lines.slice(1).forEach(line => {
                const row = line.split(',');
                if (row.length === headers.length) {
                    const make = row[0].trim();
                    const model = row[1].trim();
                    const year = row[2].trim();
                    const imageUrl = row[3].trim();
                    const partNumber = row[4].trim();

                    carData.push({ make, model, year });

                    const key = `${make}_${model}_${year}`;
                    if (!partsData[key]) {
                        partsData[key] = [];
                    }
                    partsData[key].push({ imageUrl, partNumber });
                }
            });

            populateMakes(); // Populate the make buttons
        }

        // Function to populate the 'Make' buttons based on CSV data
        function populateMakes() {
            const makeButtonsContainer = document.getElementById('make-buttons');
            makeButtonsContainer.innerHTML = '';
            const makes = [...new Set(carData.map(car => car.make))]; // Get unique makes

            makes.forEach(make => {
                const button = document.createElement('button');
                button.innerText = make;
                button.onclick = () => selectMake(make, button);
                makeButtonsContainer.appendChild(button);
            });

            fadeInElement('make-buttons'); // Fade in the make buttons
        }

        // Function to handle Make button selection
        function selectMake(make, buttonElement) {
            document.querySelectorAll('#make-buttons button').forEach(btn => btn.classList.remove('selected')); // Remove selected class from all buttons
            buttonElement.classList.add('selected'); // Add selected class to the clicked button

            const modelButtonsContainer = document.getElementById('model-buttons');
            modelButtonsContainer.innerHTML = ''; // Clear model buttons
            const models = [...new Set(carData.filter(car => car.make === make).map(car => car.model))];

            models.forEach(model => {
                const button = document.createElement('button');
                button.innerText = model;
                button.onclick = () => selectModel(make, model, button);
                modelButtonsContainer.appendChild(button);
            });

            fadeInElement('model-buttons'); // Fade in the model buttons
        }

        // Function to handle Model button selection
        function selectModel(make, model, buttonElement) {
            document.querySelectorAll('#model-buttons button').forEach(btn => btn.classList.remove('selected')); // Remove selected class from all buttons
            buttonElement.classList.add('selected'); // Add selected class to the clicked button

            const yearButtonsContainer = document.getElementById('year-buttons');
            yearButtonsContainer.innerHTML = ''; // Clear year buttons
            const years = [...new Set(carData.filter(car => car.make === make && car.model === model).map(car => car.year))];

            years.forEach(year => {
                const button = document.createElement('button');
                button.innerText = year;
                button.onclick = () => selectYear(make, model, year, button);
                yearButtonsContainer.appendChild(button);
            });

            fadeInElement('year-buttons'); // Fade in the year buttons
        }

        // Function to handle Year button selection
        function selectYear(make, model, year, buttonElement) {
            document.querySelectorAll('#year-buttons button').forEach(btn => btn.classList.remove('selected')); // Remove selected class from all buttons
            buttonElement.classList.add('selected'); // Add selected class to the clicked button

            showCarParts(make, model, year); // Show parts when year is selected
        }

        // Function to display car parts images when Make, Model, and Year are selected
        function showCarParts(make, model, year) {
            const key = `${make}_${model}_${year}`;

            const imageContainer = document.getElementById('image-container');
            imageContainer.innerHTML = ''; // Clear the container

            if (partsData[key]) {
                partsData[key].forEach(part => {
                    const container = document.createElement('div');
                    container.className = 'image-container';

                    const img = document.createElement('img');
                    img.src = part.imageUrl;
                    img.dataset.partNumber = part.partNumber;
                    img.onclick = () => selectPart(img);

                    const overlay = document.createElement('div');
                    overlay.className = 'text-overlay';
                    overlay.innerText = `Part Number: ${part.partNumber}`;

                    container.appendChild(img);
                    container.appendChild(overlay);
                    imageContainer.appendChild(container);
                });
                document.getElementById('image-display').style.display = 'block'; // Show image section
            } else {
                alert('No parts found for the selected make, model, and year.');
                document.getElementById('image-display').style.display = 'none'; // Hide image section
            }
        }

        // Function to select a part and display part number
        function selectPart(imgElement) {
            const images = document.querySelectorAll('.image-container img');
            images.forEach(img => img.classList.remove('selected')); // Remove selected class from all images
            imgElement.classList.add('selected'); // Add selected class to the clicked image

            const partNumber = imgElement.dataset.partNumber;
            document.getElementById('selected-part-number').innerText = partNumber;
            document.getElementById('purchase-suggestion').style.display = 'block'; // Show purchase suggestion
        }

        // Function to suggest purchasing a part
        function suggestPurchase() {
            const partNumber = document.getElementById('selected-part-number').innerText;
            alert('You selected part number: ' + partNumber);
        }

        // Function to fade in elements
        function fadeInElement(id) {
            const element = document.getElementById(id);
            element.classList.add('visible');
        }

        // Load CSV data when the page loads
        window.onload = function () {
            loadCSVFromURL();
        };
    </script>
</body>
</html>
